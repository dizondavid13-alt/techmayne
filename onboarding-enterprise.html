<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TechMayne - Client Onboarding</title>

  <!-- Inter Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* TechMayne Enterprise Brand Colors */
    :root {
      --primary-blue: #1E6FD9;
      --deep-navy: #0A2540;
      --metallic-gray: #8B8F97;
      --charcoal-black: #0B0B0D;
      --white: #FFFFFF;
      --bg-light: #F8F9FA;
      --border-light: #E5E7EB;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: var(--bg-light);
      min-height: 100vh;
      padding: 40px 20px;
      color: var(--charcoal-black);
      line-height: 1.6;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
    }

    /* Header */
    .header {
      text-align: center;
      margin-bottom: 48px;
    }

    .logo {
      font-size: 32px;
      font-weight: 700;
      color: var(--deep-navy);
      margin-bottom: 12px;
      letter-spacing: -0.5px;
    }

    .header h1 {
      font-size: 36px;
      font-weight: 700;
      color: var(--deep-navy);
      margin-bottom: 12px;
      letter-spacing: -0.8px;
    }

    .header p {
      font-size: 18px;
      font-weight: 400;
      color: var(--metallic-gray);
    }

    /* Card */
    .card {
      background: var(--white);
      border-radius: 16px;
      padding: 48px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
      margin-bottom: 24px;
    }

    /* Section Title */
    .section-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--deep-navy);
      margin-bottom: 24px;
      padding-bottom: 12px;
      border-bottom: 2px solid var(--border-light);
    }

    /* Form Group */
    .form-group {
      margin-bottom: 24px;
    }

    label {
      display: block;
      font-weight: 500;
      font-size: 14px;
      margin-bottom: 8px;
      color: var(--deep-navy);
    }

    .required {
      color: #DC2626;
    }

    .helper-text {
      font-size: 13px;
      color: var(--metallic-gray);
      margin-top: 6px;
    }

    /* Inputs */
    input[type="text"],
    input[type="email"],
    input[type="url"],
    input[type="tel"],
    input[type="color"],
    input[type="password"],
    select,
    textarea {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid var(--border-light);
      border-radius: 8px;
      font-size: 15px;
      font-family: 'Inter', sans-serif;
      transition: all 0.2s ease;
      background: var(--white);
      color: var(--charcoal-black);
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 3px rgba(30, 111, 217, 0.1);
    }

    textarea {
      resize: vertical;
      min-height: 100px;
    }

    /* Color Input */
    .color-input-wrapper {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    input[type="color"] {
      width: 80px;
      height: 48px;
      padding: 4px;
      cursor: pointer;
    }

    .color-preview {
      flex: 1;
      height: 48px;
      border-radius: 8px;
      border: 1px solid var(--border-light);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      font-size: 14px;
    }

    /* FAQ Item */
    .faq-item {
      background: var(--bg-light);
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 16px;
      position: relative;
      border: 1px solid var(--border-light);
    }

    .add-faq-btn,
    .remove-faq-btn {
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: 500;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Inter', sans-serif;
    }

    .add-faq-btn {
      background: var(--white);
      color: var(--primary-blue);
      border: 1px solid var(--primary-blue);
      width: 100%;
    }

    .add-faq-btn:hover {
      background: var(--primary-blue);
      color: var(--white);
    }

    .remove-faq-btn {
      background: transparent;
      color: #DC2626;
      border: 1px solid #DC2626;
      position: absolute;
      top: 16px;
      right: 16px;
      padding: 6px 12px;
      font-size: 12px;
    }

    .remove-faq-btn:hover {
      background: #DC2626;
      color: var(--white);
    }

    /* Checkbox Group */
    .checkbox-group {
      background: var(--bg-light);
      padding: 16px;
      border-radius: 8px;
      border: 1px solid var(--border-light);
      margin-bottom: 16px;
    }

    .checkbox-group input[type="checkbox"] {
      width: auto;
      margin-right: 10px;
      cursor: pointer;
    }

    .checkbox-group label {
      display: inline;
      font-weight: 400;
      cursor: pointer;
    }

    /* Installation Section */
    .installation-section {
      display: none;
      margin-top: 24px;
      padding: 24px;
      background: var(--bg-light);
      border-radius: 8px;
      border: 1px solid var(--border-light);
    }

    .installation-section.show {
      display: block;
    }

    .warning-box {
      background: #FEF3C7;
      border-left: 4px solid #F59E0B;
      padding: 16px;
      border-radius: 6px;
      margin-bottom: 24px;
      font-size: 14px;
      color: var(--charcoal-black);
    }

    /* Submit Button */
    .submit-btn {
      width: 100%;
      padding: 16px;
      background: var(--primary-blue);
      color: var(--white);
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Inter', sans-serif;
      margin-top: 32px;
    }

    .submit-btn:hover {
      background: #1557B0;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(30, 111, 217, 0.3);
    }

    .submit-btn:active {
      transform: translateY(0);
    }

    .submit-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    /* Result Card */
    .result-card {
      display: none;
      background: #ECFDF5;
      border: 2px solid #10B981;
      border-radius: 12px;
      padding: 32px;
      margin-top: 24px;
    }

    .result-card.show {
      display: block;
    }

    .result-title {
      color: #047857;
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 20px;
    }

    .embed-code {
      background: var(--charcoal-black);
      color: #10B981;
      padding: 20px;
      border-radius: 8px;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
      overflow-x: auto;
      margin: 20px 0;
      position: relative;
    }

    .copy-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #10B981;
      color: var(--white);
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      transition: all 0.2s ease;
    }

    .copy-btn:hover {
      background: #059669;
    }

    .instructions {
      background: var(--white);
      padding: 24px;
      border-radius: 8px;
      margin-top: 20px;
      border: 1px solid var(--border-light);
    }

    .instructions h4 {
      color: var(--deep-navy);
      font-weight: 600;
      margin-bottom: 12px;
    }

    details {
      margin: 12px 0;
      padding: 12px;
      background: var(--bg-light);
      border-radius: 6px;
      cursor: pointer;
    }

    summary {
      font-weight: 500;
      color: var(--deep-navy);
      cursor: pointer;
      user-select: none;
    }

    details ol {
      margin-top: 12px;
      margin-left: 20px;
    }

    /* Error Message */
    .error-message {
      background: #FEE2E2;
      color: #991B1B;
      padding: 16px;
      border-radius: 8px;
      margin-top: 20px;
      display: none;
      border-left: 4px solid #DC2626;
    }

    .error-message.show {
      display: block;
    }

    /* Responsive */
    @media (max-width: 640px) {
      .card {
        padding: 32px 24px;
      }

      .header h1 {
        font-size: 28px;
      }

      .header p {
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">TechMayne</div>
      <h1>Client Onboarding</h1>
      <p>Set up your AI chatbot in minutes</p>
    </div>

    <form id="onboardingForm" class="card">
      <h2 class="section-title">Business Information</h2>

      <div class="form-group">
        <label>Business Name <span class="required">*</span></label>
        <input type="text" id="businessName" name="businessName" required placeholder="Your Photography Studio">
      </div>

      <div class="form-group">
        <label>Website URL <span class="required">*</span></label>
        <input type="url" id="websiteUrl" name="websiteUrl" required placeholder="https://yourwebsite.com">
      </div>

      <div class="form-group">
        <label>Notification Email <span class="required">*</span></label>
        <input type="email" id="notificationEmail" name="notificationEmail" required placeholder="you@email.com">
        <div class="helper-text">You'll receive lead notifications here</div>
      </div>

      <div class="form-group">
        <label>Phone Number <span class="required">*</span></label>
        <input type="tel" id="phoneNumber" name="phoneNumber" required placeholder="(555) 123-4567">
        <div class="helper-text">For urgent notifications and 2FA if needed</div>
      </div>

      <h2 class="section-title" style="margin-top: 40px;">Customize Your Chatbot</h2>

      <div class="form-group">
        <label>Booking/Calendar Link</label>
        <input type="url" id="bookingLink" name="bookingLink" placeholder="https://calendly.com/yourusername">
        <div class="helper-text">Calendly, Acuity, or any scheduling link</div>
      </div>

      <div class="form-group">
        <label>Service Area</label>
        <input type="text" id="serviceArea" name="serviceArea" placeholder="San Francisco Bay Area">
      </div>

      <div class="form-group">
        <label>Starting Price</label>
        <input type="text" id="startingPrice" name="startingPrice" placeholder="$2,500">
        <div class="helper-text">Your packages starting price (displayed to visitors)</div>
      </div>

      <div class="form-group">
        <label>Gallery Delivery Timeline</label>
        <input type="text" id="galleryTimeline" name="galleryTimeline" placeholder="4-6 weeks" value="4-6 weeks">
        <div class="helper-text">How long until clients receive their photos?</div>
      </div>

      <div class="form-group">
        <label>Chatbot Accent Color</label>
        <div class="color-input-wrapper">
          <input type="color" id="accentColor" name="accentColor" value="#1E6FD9">
          <div class="color-preview" id="colorPreview" style="background: #1E6FD9;">
            <span style="color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">#1E6FD9</span>
          </div>
        </div>
        <div class="helper-text">Choose a color that matches your brand</div>
      </div>

      <h2 class="section-title" style="margin-top: 40px;">Custom FAQs (Optional)</h2>
      <p style="margin-bottom: 20px; color: var(--metallic-gray);">Add questions specific to your business. We've already included 4 default FAQs for you.</p>

      <div id="customFaqContainer"></div>

      <button type="button" class="add-faq-btn" onclick="addCustomFaq()">+ Add Custom FAQ</button>

      <h2 class="section-title" style="margin-top: 40px;">Installation Preference</h2>

      <div class="checkbox-group">
        <input type="checkbox" id="needInstallation" name="needInstallation" onchange="toggleInstallationSection()">
        <label for="needInstallation">
          <strong>I need help installing the chatbot</strong><br>
          <span class="helper-text">Check this if you'd like us to install the chatbot for you within 48 hours ($50 one-time fee)</span>
        </label>
      </div>

      <div id="installationSection" class="installation-section">
        <h3 style="color: var(--deep-navy); margin-bottom: 16px; font-weight: 600;">Installation Service Details</h3>

        <div class="warning-box">
          <strong>ðŸ”’ Your Information is Secure</strong><br>
          We only use your login credentials to install the chatbot code on your website. We'll never access any other data or make unauthorized changes. Your credentials are deleted immediately after installation.
        </div>

        <div class="form-group">
          <label>Website Platform <span class="required">*</span></label>
          <select id="websitePlatform" name="websitePlatform">
            <option value="">Select your platform</option>
            <option value="squarespace">Squarespace</option>
            <option value="wordpress">WordPress</option>
            <option value="wix">Wix</option>
            <option value="showit">Showit</option>
            <option value="shopify">Shopify</option>
            <option value="weebly">Weebly</option>
            <option value="godaddy">GoDaddy Website Builder</option>
            <option value="other">Other (please specify below)</option>
          </select>
        </div>

        <div class="form-group">
          <label>Website Login Username/Email <span class="required">*</span></label>
          <input type="text" id="websiteUsername" name="websiteUsername" placeholder="your_username or email@example.com">
        </div>

        <div class="form-group">
          <label>Website Login Password <span class="required">*</span></label>
          <input type="password" id="websitePassword" name="websitePassword" placeholder="Your password">
          <div class="helper-text">Your password is encrypted and deleted after installation</div>
        </div>

        <div class="form-group">
          <label>Two-Factor Authentication (2FA) Status</label>
          <select id="twoFactorStatus" name="twoFactorStatus">
            <option value="disabled">Disabled - No 2FA on my account</option>
            <option value="enabled_can_disable">Enabled - I can temporarily disable it</option>
            <option value="enabled_will_provide">Enabled - I'll provide the code when needed</option>
          </select>
          <div class="helper-text">If enabled, we'll text you via SMS when we need the 2FA code (time-sensitive)</div>
        </div>

        <div class="form-group">
          <label>Special Instructions (Optional)</label>
          <textarea id="installationNotes" name="installationNotes" placeholder="Any special instructions or concerns about your website setup?"></textarea>
        </div>

        <div class="checkbox-group" style="background: #DBEAFE; border-color: var(--primary-blue);">
          <input type="checkbox" id="installationConsent" name="installationConsent">
          <label for="installationConsent">
            <strong style="color: var(--deep-navy);">I authorize TechMayne to access my website</strong><br>
            <span style="color: var(--deep-navy);">I understand that TechMayne will access my website solely to install the chatbot code and will not make any other changes. My credentials will be deleted after installation.</span>
          </label>
        </div>
      </div>

      <button type="submit" class="submit-btn" id="submitBtn">
        Complete Setup
      </button>

      <div id="errorMessage" class="error-message"></div>
    </form>

    <div id="resultCard" class="card result-card">
      <div class="result-title">âœ“ Success! Your Chatbot is Ready</div>

      <p><strong>Client Token:</strong> <code id="clientToken"></code></p>

      <div style="margin-top: 24px;">
        <strong>Your Embed Code:</strong>
        <div class="embed-code" id="embedCodeContainer">
          <button class="copy-btn" onclick="copyEmbedCode()">Copy</button>
          <code id="embedCode"></code>
        </div>
      </div>

      <div class="instructions">
        <h4>Installation Instructions</h4>
        <p><strong>Choose your platform:</strong></p>

        <details>
          <summary>Squarespace</summary>
          <ol style="margin-top: 12px;">
            <li>Go to Settings â†’ Advanced â†’ Code Injection</li>
            <li>Paste the code in the "Footer" section</li>
            <li>Click Save</li>
          </ol>
        </details>

        <details>
          <summary>WordPress</summary>
          <ol style="margin-top: 12px;">
            <li>Go to Appearance â†’ Theme Editor</li>
            <li>Open footer.php (or use a plugin like "Insert Headers and Footers")</li>
            <li>Paste code before &lt;/body&gt; tag</li>
            <li>Update file</li>
          </ol>
        </details>

        <details>
          <summary>Wix</summary>
          <ol style="margin-top: 12px;">
            <li>Go to Settings â†’ Custom Code</li>
            <li>Click "+ Add Custom Code"</li>
            <li>Paste code, select "Body - End"</li>
            <li>Apply to all pages</li>
          </ol>
        </details>

        <details>
          <summary>Showit</summary>
          <ol style="margin-top: 12px;">
            <li>Go to Site Settings â†’ Advanced â†’ Custom Code</li>
            <li>Paste in "Footer Code" section</li>
            <li>Publish your site</li>
          </ol>
        </details>
      </div>

      <div style="margin-top: 24px; padding: 20px; background: #DBEAFE; border-radius: 8px; border-left: 4px solid var(--primary-blue);">
        <strong>Next Step:</strong> Visit your website to see the chat widget in action!
      </div>
    </div>
  </div>

  <script>
    const API_URL = 'https://techmayne-production.up.railway.app';

    let customFaqCount = 0;

    // Color preview
    document.getElementById('accentColor').addEventListener('input', function(e) {
      const color = e.target.value;
      const preview = document.getElementById('colorPreview');
      preview.style.background = color;
      preview.querySelector('span').textContent = color;
    });

    // Toggle installation section
    function toggleInstallationSection() {
      const checkbox = document.getElementById('needInstallation');
      const section = document.getElementById('installationSection');

      if (checkbox.checked) {
        section.classList.add('show');
        document.getElementById('websitePlatform').required = true;
        document.getElementById('websiteUsername').required = true;
        document.getElementById('websitePassword').required = true;
      } else {
        section.classList.remove('show');
        document.getElementById('websitePlatform').required = false;
        document.getElementById('websiteUsername').required = false;
        document.getElementById('websitePassword').required = false;
      }
    }

    // Add custom FAQ
    function addCustomFaq() {
      customFaqCount++;
      const container = document.getElementById('customFaqContainer');

      const faqItem = document.createElement('div');
      faqItem.className = 'faq-item';
      faqItem.id = `faq-${customFaqCount}`;
      faqItem.innerHTML = `
        <button type="button" class="remove-faq-btn" onclick="removeFaq(${customFaqCount})">Remove</button>
        <label>Question:</label>
        <input type="text" name="faq_question_${customFaqCount}" placeholder="e.g., Do you offer engagement sessions?">

        <label style="margin-top: 12px;">Answer:</label>
        <textarea name="faq_answer_${customFaqCount}" placeholder="Your answer here..." style="min-height: 80px;"></textarea>

        <label style="margin-top: 12px;">Keywords (comma-separated):</label>
        <input type="text" name="faq_keywords_${customFaqCount}" placeholder="e.g., engagement, session, couples">
        <div class="helper-text">Keywords help the chatbot match this FAQ to visitor questions</div>
      `;

      container.appendChild(faqItem);
    }

    // Remove FAQ
    function removeFaq(id) {
      const faqItem = document.getElementById(`faq-${id}`);
      faqItem.remove();
    }

    // Form submission
    document.getElementById('onboardingForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      const submitBtn = document.getElementById('submitBtn');
      const errorMessage = document.getElementById('errorMessage');
      const resultCard = document.getElementById('resultCard');
      const needInstallation = document.getElementById('needInstallation').checked;

      // Validate installation consent if installation is selected
      if (needInstallation) {
        const consent = document.getElementById('installationConsent').checked;
        if (!consent) {
          errorMessage.textContent = 'Please authorize us to access your website for installation.';
          errorMessage.classList.add('show');
          return;
        }
      }

      // Disable button
      submitBtn.disabled = true;
      submitBtn.textContent = 'Creating your chatbot...';
      errorMessage.classList.remove('show');
      resultCard.classList.remove('show');

      // Gather custom FAQs
      const customFaqs = [];
      for (let i = 1; i <= customFaqCount; i++) {
        const questionInput = document.querySelector(`input[name="faq_question_${i}"]`);
        const answerInput = document.querySelector(`textarea[name="faq_answer_${i}"]`);
        const keywordsInput = document.querySelector(`input[name="faq_keywords_${i}"]`);

        if (questionInput && questionInput.value && answerInput && answerInput.value) {
          customFaqs.push({
            question: questionInput.value,
            answer: answerInput.value,
            keywords: keywordsInput ? keywordsInput.value : ''
          });
        }
      }

      // Gather form data
      const formData = {
        businessName: document.getElementById('businessName').value,
        websiteUrl: document.getElementById('websiteUrl').value,
        notificationEmail: document.getElementById('notificationEmail').value,
        phoneNumber: document.getElementById('phoneNumber').value,
        bookingLink: document.getElementById('bookingLink').value || null,
        serviceArea: document.getElementById('serviceArea').value || null,
        startingPrice: document.getElementById('startingPrice').value || null,
        galleryTimeline: document.getElementById('galleryTimeline').value || '4-6 weeks',
        accentColor: document.getElementById('accentColor').value,
        customFaqs: customFaqs
      };

      // Add installation data if selected
      if (needInstallation) {
        formData.installation = {
          needsInstallation: true,
          platform: document.getElementById('websitePlatform').value,
          username: document.getElementById('websiteUsername').value,
          password: document.getElementById('websitePassword').value,
          twoFactorStatus: document.getElementById('twoFactorStatus').value,
          instructions: document.getElementById('installationNotes').value || null
        };
      }

      try {
        // Call API
        const response = await fetch(`${API_URL}/api/onboarding/create`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData)
        });

        const data = await response.json();

        if (data.success) {
          // Show success
          document.getElementById('clientToken').textContent = data.client.clientToken;
          document.getElementById('embedCode').textContent = data.embedCode;
          resultCard.classList.add('show');

          // Scroll to result
          resultCard.scrollIntoView({ behavior: 'smooth' });
        } else {
          throw new Error(data.error || 'Something went wrong');
        }
      } catch (error) {
        errorMessage.textContent = `Error: ${error.message}`;
        errorMessage.classList.add('show');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Complete Setup';
      }
    });

    function copyEmbedCode() {
      const code = document.getElementById('embedCode').textContent;
      navigator.clipboard.writeText(code);

      const btn = event.target;
      btn.textContent = 'âœ“ Copied!';
      setTimeout(() => {
        btn.textContent = 'Copy';
      }, 2000);
    }
  </script>
</body>
</html>
